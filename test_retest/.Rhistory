table(qc_func_trta$site, qc_func_trta$session)
calc_icc <- function(x) {
# ICC Juicy Core
nFact <- 2
myStat<-vector(mode="numeric", length=nFact+1)
fmAOV <- lmer(value ~ 1 + (1|subject) + (1|session), x)
for(i in 1:nFact) myStat[i] <- VarCorr(fmAOV)[[i]][1]  # factor variances
myStat[nFact+1] <- attr(VarCorr(fmAOV), "sc")^2  # residual variance
myStat <- myStat/sum(myStat)
icc <- myStat[1]
return(icc)
}
qc_func_icc <- ddply(qc_func_trt_btw, .(measure, site), function(x) {
# matrix: subject x session
x$subject <- as.factor(x$subject)
res <- calc_icc(x)
nsubjects <- length(unique(x$subject))
nsessions <- length(unique(x$session))
c(subjects=nsubjects, sessions=nsessions, icc=res)
})
write.csv(qc_anat_icc, file="qc_anat_icc_btw_sess.csv")
write.csv(qc_func_icc_btw, file="qc_func_icc_btw_sess.csv")
qc_func_icc_btw <- ddply(qc_func_trt_btw, .(measure, site), function(x) {
# matrix: subject x session
x$subject <- as.factor(x$subject)
res <- calc_icc(x)
nsubjects <- length(unique(x$subject))
nsessions <- length(unique(x$session))
c(subjects=nsubjects, sessions=nsessions, icc=res)
})
write.csv(qc_anat_icc, file="qc_anat_icc_btw_sess.csv")
write.csv(qc_func_icc_btw, file="qc_func_icc_btw_sess.csv")
anat_icc <- read.csv("qc_anat_icc_btw_sess.csv")
func_icc <- read.csv("qc_func_icc_btw_sess.csv")
library(ggplot2)
library(grid)
library(RColorBrewer)
source("../plot_measures/qa_plot_functions.R")
anat_icc$measure <- sub("^anat_", "", anat_icc$measure)
func_icc$measure <- sub("^func_", "", func_icc$measure)
func_icc <- func_icc[func_icc$measure != "num_fd",]
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
ggtitle("Reliability of Anatomical Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
anat_icc$measure
unique(anat_icc$measure)
anat_icc$measure <- factor(anat_icc$measure,
levels=c("cnr", "efc", "fber", "fwhm", "qi1", "snr"),
labels=c("CNR", "EFC", "FBER", "FWHM", "Qi1", "SNR"))
anat_icc
head(func_icc$measure)
head(func_icc)
unique(func_icc$measure)
anat_icc <- read.csv("qc_anat_icc_btw_sess.csv")
func_icc <- read.csv("qc_func_icc_btw_sess.csv")
#+ format
anat_icc$measure <- sub("^anat_", "", anat_icc$measure)
func_icc$measure <- sub("^func_", "", func_icc$measure)
func_icc <- func_icc[func_icc$measure != "num_fd",]
#+ relabel
anat_icc$measure <- factor(anat_icc$measure,
levels=c("cnr", "efc", "fber", "fwhm", "qi1", "snr"),
labels=c("CNR", "EFC", "FBER", "FWHM", "Qi1", "SNR"))
func_icc$measure <- factor(func_icc$measure,
levels=c( "efc","fber","fwhm","gsr","dvars","quality","mean_fd","perc_fd")
labels=c("EFC", "FBER", "FWHM", "GSR", "DVARS", "Quality", "Mean FD", "Percent FD"))
anat_icc <- read.csv("qc_anat_icc_btw_sess.csv")
func_icc <- read.csv("qc_func_icc_btw_sess.csv")
#+ format
anat_icc$measure <- sub("^anat_", "", anat_icc$measure)
func_icc$measure <- sub("^func_", "", func_icc$measure)
func_icc <- func_icc[func_icc$measure != "num_fd",]
#+ relabel
anat_icc$measure <- factor(anat_icc$measure,
levels=c("cnr", "efc", "fber", "fwhm", "qi1", "snr"),
labels=c("CNR", "EFC", "FBER", "FWHM", "Qi1", "SNR"))
func_icc$measure <- factor(func_icc$measure,
levels=c( "efc","fber","fwhm","gsr","dvars","quality","mean_fd","perc_fd"),
labels=c("EFC", "FBER", "FWHM", "GSR", "DVARS", "Quality", "Mean FD", "Percent FD"))
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
ggtitle("Reliability of Anatomical Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=1) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
ggsave("anat_icc_btw.png", width=8, height=5, dpi=100)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=1) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_violin() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=1) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=1) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
anat_icc[anat_icc$icc==0,]
anat_icc[anat_icc$icc<0.2,]
anat_icc[anat_icc$icc<0.1,]
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=1) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=24)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=20, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=20, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=1) +
ylab("ICC") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=24)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=20, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=20, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("ICC") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=24)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=20, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=20, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("ICC") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=24)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=20, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=20, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=24)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=20, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=20, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=24)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=24, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=24, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank() +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=24, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=24, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=24, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=24, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=24, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=24, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=24, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot(lwd=2) +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=24, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=24, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.3,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_boxplot(lwd=2) +
geom_hline(yintercept=0.5, lty=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
ggsave("anat_icc_btw.png", width=8, height=5, dpi=100)
p3 <- ggplot(func_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p3)
p3 <- ggplot(func_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=0.95, hjust=0.5, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p3)
p3 <- ggplot(func_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p3)
p3 <- ggplot(func_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=1, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p3)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=1, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p1)
ggsave("anat_icc_btw.png", width=8, height=5, dpi=100)
p3 <- ggplot(func_icc, aes(x=measure, y=icc, color=measure)) +
geom_hline(yintercept=0.5, lty=2) +
geom_boxplot(lwd=2) +
ylab("") +
xlab("") +
theme_bw() +
theme(axis.title.x      = element_blank()) +
theme(axis.title.y      = element_blank()) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=28, vjust=1, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=28, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.45,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines")) +
theme(legend.position="none")
plot(p3)
ggsave("func_icc_btw.png", width=8, height=5, dpi=100)
plot(p1)
