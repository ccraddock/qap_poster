theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p0)
warnings()
setwd("~/Dropbox/Research/cmi/qap_poster/classification")
x <- qc_func
x$score <- x$rater_2
score <- as.character(x$score)
score[score == "maybe"] <- "fail"
x$score <- factor(score)
mylogit <- glm(score ~ efc + fber + fwhm + dvars + quality + mean_fd + perc_fd + gsr, data=x, family="binomial", na.action=na.omit)
summary(mylogit)
x <- qc_anat
x$score <- x$rater_2
score <- as.character(x$score)
score[score == "maybe"] <- "fail"
x$score <- factor(score)
mylogit <- glm(score ~ cnr + efc + fwhm + fber + qi1 + snr, data=x, family="binomial", na.action=na.omit)
summary(mylogit)
mylm <- lm(score ~ cnr + efc + fwhm + fber + qi1 + snr, data=x, na.action=na.omit)
summary(mylm)
mylm <- lm(as.numeric(score) ~ cnr + efc + fwhm + fber + qi1 + snr, data=x, na.action=na.omit)
summary(mylm)
t.test(cnr ~ score, data=x)
t.test(efc ~ score, data=x)
t.test(fwhm ~ score, data=x)
head(x)
ggplot(x, aes(x=rater_1, y=cnr)) + geom_boxplot()
ggplot(x, aes(x=score, y=cnr)) + geom_boxplot()
ggplot(x[!is.na(x$score),], aes(x=rater_1, y=cnr)) + geom_boxplot()
ggplot(x[!is.na(x$score),], aes(x=score, y=cnr)) + geom_boxplot()
ggplot(x[!is.na(x$score),], aes(x=score, y=efc)) + geom_boxplot()
ggplot(x[!is.na(x$score),], aes(x=score, y=fber)) + geom_boxplot()
plot(p0)
head(qc_func)
id.vars <- c("subject", "site", "rater_1", "rater_2", "rater_3")
measure.vars <- c("efc", "fber", "fwhm", "dvars", "quality", "mean_fd", "perc_fd", "gsr")
qc_func2 <- melt(qc_func, id.vars=id.vars, measure.vars=measure.vars, variable.name="measure")
qc_func2 <- melt(qc_func2, measure.vars=id.vars[3:5], variable.name="rater", value.name="score")
qc_func2$rater <- factor(qc_func2$rater, levels=c("rater_1", "rater_2", "rater_3"), labels=1:3)
qc_func2$score <- factor(qc_func2$score)
head(qc_func2)
id.vars <- c("subject", "site", "rater_1", "rater_2", "rater_3")
measure.vars <- c("efc", "fber", "fwhm", "dvars", "quality", "mean_fd", "perc_fd", "gsr")
qc_func2 <- melt(qc_func, id.vars=id.vars, measure.vars=measure.vars, variable.name="measure")
head(qc_func2)
qc_func2 <- melt(qc_func2, measure.vars=id.vars[3:5], variable.name="rater", value.name="score")
head(qc_func2)
qc_func2$rater <- factor(qc_func2$rater, levels=c("rater_1", "rater_2", "rater_3"), labels=1:3)
qc_func2$score <- factor(qc_func2$score)
head(qc_func2)
table(qc_func2$score)
score <- as.character(qc_anat2$score)
score[score == "maybe"] <- "fail"
qc_anat2$score <- factor(score)
table(qc_func2$score)
score <- as.character(qc_func2$score)
score[score == "maybe"] <- "fail"
qc_func2$score <- factor(score)
table(qc_func2$score)
source("../plot_measures/qa_plot_functions.R")
df <- subset(qc_func2)
df <- ddply(df, .(measure), function(x) {
x <- x[!is.na(x$value),]
inds <- get_outlier_inds(x$value)
cat(sum(inds), "\n")
x[!inds,]
})
# create boxplot that includes outliers
p1 <- ggplot(df, aes(x=rater, y=value, color=score)) +
geom_boxplot(outlier.shape = NA) +
facet_grid(measure ~ ., scales="free_y") +
ylab("QC Value") +
xlab("Rater") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
setwd("~/Dropbox/Research/cmi/qap_poster/classification")
setwd("~/Dropbox/Research/cmi/qap_poster/classification")
library(ICC)
library(irr)
library(plyr)
library(reshape2)
qc_anat <- read.csv("../data/corr_anat.csv")
qc_func <- read.csv("../data/corr_func.csv")
setwd("~/Dropbox/Research/cmi/qap_poster/test_retest")
anat_icc <- read.csv("qc_anat_icc_btw_sess.csv")
anat_ken <- read.csv("qc_anat_kendall_btw_sess.csv")
func_icc <- read.csv("qc_func_icc_btw_sess.csv")
func_ken <- read.csv("qc_func_kendall_btw_sess.csv")
head(anat_icc)
ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot()
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
ylab("ICC") +
xlab("Measure") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
anat_icc$measure <- sub("^anat_", "", anat_icc$measure)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
ylab("ICC") +
xlab("Measure") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5) +
ylab("ICC") +
xlab("Measure") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
ylab("ICC") +
xlab("Measure") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("Measure") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=14, vjust=0.95, hjust=1, angle=45)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=1, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.5, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
anat_ken$measure <- sub("^anat_", "", anat_ken$measure)
head(anat_ken)
anat_ken
p2 <- ggplot(anat_kendall, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("Kendall's W") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p2)
p2 <- ggplot(anat_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("Kendall's W") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p2)
anat_ken$wt[anat_ken$pval > 0.05]
p2 <- ggplot(anat_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.75, lty=2) +
geom_hline(yintercept=0.5, lty=3) +
ylab("Kendall's W") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p2)
p2 <- ggplot(anat_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.75, lty=2) +
geom_hline(yintercept=0.5, lty=3) +
ylab("Kendall's W") +
xlab("") +
ylim(c(0,1)) +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p2)
head(func_icc)
func_icc$measure <- sub("^func_", "", func_icc$measure)
func_ken$measure <- sub("^func_", "", func_ken$measure)
p3 <- ggplot(func_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p3)
p4 <- ggplot(func_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.75, lty=2) +
geom_hline(yintercept=0.5, lty=3) +
ylab("Kendall's W") +
xlab("") +
ylim(c(0,1)) +
ggtitle("Consistency of Functional Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p4)
?ggsave
setwd("~/Dropbox/Research/cmi/qap_poster/test_retest")
p1 <- ggplot(anat_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
ggtitle("Reliability of Anatomical Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p1)
ggsave("anat_icc_btw.png", width=8, height=5, dpi=100)
p2 <- ggplot(anat_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.75, lty=2) +
geom_hline(yintercept=0.5, lty=3) +
ylab("Kendall's W") +
xlab("") +
ylim(c(0,1)) +
ggtitle("Consistency of Anatomical Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p2)
ggsave("anat_ken_btw.png", width=8, height=5, dpi=100)
p3 <- ggplot(func_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
ggtitle("Reliability of Functional Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p3)
ggsave("func_icc_btw.png", width=8, height=5, dpi=100)
p4 <- ggplot(func_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.75, lty=2) +
geom_hline(yintercept=0.5, lty=3) +
ylab("Kendall's W") +
xlab("") +
ylim(c(0,1)) +
ggtitle("Consistency of Functional Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p4)
ggsave("func_ken_btw.png", width=8, height=5, dpi=100)
head(func_icc)
func_icc <- func_icc[func_icc$measure != "num_fd",]
func_ken <- func_ken[func_ken$measure != "num_fd",]
#+ plot-func-icc
p3 <- ggplot(func_icc, aes(x=measure, y=icc)) +
geom_boxplot() +
geom_hline(yintercept=0.5, lty=2) +
geom_hline(yintercept=0, lty=3) +
ylab("ICC") +
xlab("") +
ggtitle("Reliability of Functional Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p3)
ggsave("func_icc_btw.png", width=8, height=5, dpi=100)
#+ plot-func-kendall
p4 <- ggplot(func_ken, aes(x=measure, y=wt)) +
geom_boxplot() +
geom_hline(yintercept=0.75, lty=2) +
geom_hline(yintercept=0.5, lty=3) +
ylab("Kendall's W") +
xlab("") +
ylim(c(0,1)) +
ggtitle("Consistency of Functional Measures") +
theme(axis.title.x      = element_text(family = "Times", face = "plain",
size=18)) +
theme(axis.title.y      = element_text(family = "Times", face = "plain",
size=18, angle=90, vjust=0.75)) +
theme(axis.text.x       = element_text(family = "Times", face = "plain",
size=16, vjust=0.95, hjust=0.5, angle=0)) +
theme(axis.text.y       = element_text(family = "Times", face = "plain",
size=16, angle=0, hjust=0.5)) +
theme(axis.ticks.length = unit(.15, "lines")) +
theme(axis.ticks.margin = unit(.15,"lines")) +
theme(plot.margin       = unit(c(1, 1, 0.25, 1), "lines"))
plot(p4)
ggsave("func_ken_btw.png", width=8, height=5, dpi=100)
